-- Step 2: Insert daily performance data
-- This data will populate the daily_transactions table with Pidge performance metrics

-- First, we need to get rider IDs for the pidge_rider_ids
-- The INSERT will use a subquery to match pidge_rider_id to rider.id

INSERT INTO daily_transactions (
    rider_id,
    date,
    pidge_orders,
    pidge_distance_km,
    pidge_daily_earning,
    pidge_daily_incentive,
    pidge_total,
    slab_amount,
    final_payout,
    created_at
)
SELECT 
    r.id as rider_id,
    data.date::DATE,
    data.orders,
    0 as pidge_distance_km, -- Distance not provided in CSV
    data.order_earning,
    data.milestone_incentive,
    data.order_earning as pidge_total, -- Total from Pidge (before company bonus)
    data.total_payout as slab_amount, -- Total payout including bonuses
    data.total_payout as final_payout,
    NOW()
FROM (VALUES
    ('28536', '2025-11-17', 26, 856.25, 900, 1756.25),
    ('28536', '2025-11-18', 2, 62.64, 0, 62.64),
    ('28536', '2025-11-19', 1, 26.8, 0, 26.8),
    ('28536', '2025-11-20', 1, 28.88, 0, 28.88),
    ('28536', '2025-11-21', 1, 35.12, 0, 35.12),
    ('28536', '2025-11-22', 4, 139.32, 0, 139.32),
    ('28553', '2025-11-18', 9, 308.01, 200, 508.01),
    ('28553', '2025-11-19', 26, 887.29, 900, 1787.29),
    ('28553', '2025-11-20', 26, 899.83, 900, 1799.83),
    ('28553', '2025-11-21', 9, 291.36, 200, 491.36),
    ('28553', '2025-11-22', 9, 293.52, 200, 493.52),
    ('28553', '2025-11-23', 9, 276.92, 200, 476.92),
    ('28590', '2025-11-21', 5, 185.06, 0, 185.06),
    ('29717', '2025-11-17', 3, 109.84, 0, 109.84),
    ('29717', '2025-11-18', 14, 456.76, 200, 656.76),
    ('30028', '2025-11-19', 4, 143.84, 0, 143.84),
    ('30968', '2025-11-17', 37, 1314.73, 2250, 3564.73),
    ('30968', '2025-11-19', 31, 1147.95, 900, 2047.95),
    ('30968', '2025-11-20', 2, 71.92, 0, 71.92),
    ('30968', '2025-11-22', 37, 1277.08, 2250, 3527.08),
    ('30970', '2025-11-23', 1, 25.8, 0, 25.8),
    ('31733', '2025-11-18', 17, 546.16, 400, 946.16),
    ('31733', '2025-11-19', 37, 1242.66, 2250, 3492.66),
    ('31733', '2025-11-20', 3, 101.64, 0, 101.64),
    ('31733', '2025-11-21', 26, 884.96, 900, 1784.96),
    ('31733', '2025-11-22', 38, 1240.17, 2250, 3490.17),
    ('31733', '2025-11-23', 17, 561.27, 400, 961.27),
    ('31831', '2025-11-17', 26, 875.34, 900, 1775.34),
    ('31831', '2025-11-18', 17, 617.58, 400, 1017.58),
    ('31831', '2025-11-19', 26, 840.52, 900, 1740.52),
    ('31831', '2025-11-20', 17, 556.59, 400, 956.59),
    ('31831', '2025-11-21', 26, 867.91, 900, 1767.91),
    ('31831', '2025-11-22', 26, 869.37, 900, 1769.37),
    ('31831', '2025-11-23', 17, 569.69, 400, 969.69),
    ('31901', '2025-11-17', 26, 808.2, 900, 1708.2),
    ('31901', '2025-11-18', 26, 877.71, 900, 1777.71),
    ('31901', '2025-11-19', 37, 1201.28, 2250, 3451.28),
    ('31901', '2025-11-20', 37, 1241.62, 2250, 3491.62),
    ('31901', '2025-11-21', 37, 1226.35, 2250, 3476.35),
    ('31901', '2025-11-22', 26, 852, 900, 1752),
    ('31901', '2025-11-23', 26, 846.04, 900, 1746.04),
    ('32141', '2025-11-18', 1, 38.92, 0, 38.92),
    ('32141', '2025-11-19', 1, 34.8, 0, 34.8),
    ('32141', '2025-11-20', 1, 30.96, 0, 30.96),
    ('32141', '2025-11-21', 1, 28.12, 0, 28.12),
    ('32398', '2025-11-17', 26, 840.19, 900, 1740.19),
    ('32398', '2025-11-18', 26, 876.73, 900, 1776.73),
    ('32398', '2025-11-19', 26, 834.7, 900, 1734.7),
    ('32398', '2025-11-20', 2, 59.16, 0, 59.16),
    ('32398', '2025-11-21', 26, 891.46, 900, 1791.46),
    ('32398', '2025-11-22', 26, 953.25, 900, 1853.25),
    ('32398', '2025-11-23', 37, 1255.11, 2250, 3505.11),
    ('32584', '2025-11-17', 26, 824.04, 900, 1724.04),
    ('32584', '2025-11-18', 26, 867.49, 900, 1767.49),
    ('32584', '2025-11-19', 26, 937.46, 900, 1837.46),
    ('32584', '2025-11-20', 26, 958.97, 900, 1858.97),
    ('32584', '2025-11-21', 37, 1310.78, 2250, 3560.78),
    ('32584', '2025-11-23', 37, 1256.85, 2250, 3506.85),
    ('32754', '2025-11-17', 26, 937.18, 900, 1837.18),
    ('32754', '2025-11-18', 26, 878.22, 900, 1778.22),
    ('32754', '2025-11-19', 26, 951.38, 900, 1851.38),
    ('32754', '2025-11-20', 9, 321.74, 200, 521.74),
    ('32754', '2025-11-21', 1, 38.94, 0, 38.94),
    ('33285', '2025-11-17', 26, 897.41, 900, 1797.41),
    ('33285', '2025-11-18', 1, 34.88, 0, 34.88),
    ('33285', '2025-11-19', 17, 625.65, 400, 1025.65),
    ('33285', '2025-11-20', 26, 901.75, 900, 1801.75),
    ('33285', '2025-11-21', 17, 614.15, 400, 1014.15),
    ('33285', '2025-11-22', 26, 927.98, 900, 1827.98),
    ('33285', '2025-11-23', 26, 940.69, 900, 1840.69),
    ('33503', '2025-11-19', 9, 322.28, 200, 522.28),
    ('33503', '2025-11-20', 1, 34.92, 0, 34.92),
    ('33503', '2025-11-21', 1, 32.24, 0, 32.24),
    ('33531', '2025-11-18', 18, 585.05, 400, 985.05),
    ('33621', '2025-11-17', 26, 910.08, 900, 1810.08),
    ('33621', '2025-11-18', 26, 949.95, 900, 1849.95),
    ('33621', '2025-11-19', 36, 1376.25, 900, 2276.25),
    ('33621', '2025-11-20', 26, 914.95, 900, 1814.95),
    ('33621', '2025-11-21', 9, 311.7, 200, 511.7),
    ('33621', '2025-11-22', 37, 1329.26, 2250, 3579.26),
    ('33621', '2025-11-23', 26, 968.21, 900, 1868.21),
    ('33623', '2025-11-17', 37, 1252.61, 2250, 3502.61),
    ('33623', '2025-11-18', 37, 1299.64, 2250, 3549.64),
    ('33623', '2025-11-19', 37, 1258.48, 2250, 3508.48),
    ('33623', '2025-11-20', 37, 1285.22, 2250, 3535.22),
    ('33623', '2025-11-21', 36, 1297.47, 900, 2197.47),
    ('33623', '2025-11-22', 37, 1320.7, 2250, 3570.7),
    ('33623', '2025-11-23', 26, 940.83, 900, 1840.83),
    ('33673', '2025-11-17', 21, 678.07, 400, 1078.07),
    ('33673', '2025-11-18', 37, 1232.48, 2250, 3482.48),
    ('33673', '2025-11-22', 27, 901.78, 900, 1801.78),
    ('33673', '2025-11-23', 17, 650.75, 400, 1050.75),
    ('33700', '2025-11-18', 17, 612.78, 400, 1012.78),
    ('33700', '2025-11-19', 17, 577.84, 400, 977.84),
    ('33700', '2025-11-21', 15, 577.06, 200, 777.06),
    ('33700', '2025-11-22', 17, 602.99, 400, 1002.99),
    ('33700', '2025-11-23', 9, 302.92, 200, 502.92),
    ('33797', '2025-11-17', 2, 63.04, 0, 63.04),
    ('33797', '2025-11-18', 12, 436.28, 200, 636.28),
    ('33797', '2025-11-19', 27, 961.74, 900, 1861.74),
    ('33797', '2025-11-20', 9, 315.27, 200, 515.27),
    ('33797', '2025-11-21', 17, 603.9, 400, 1003.9),
    ('33797', '2025-11-22', 17, 586.9, 400, 986.9),
    ('33797', '2025-11-23', 37, 1323.66, 2250, 3573.66),
    ('33833', '2025-11-19', 9, 314.46, 200, 514.46),
    ('34121', '2025-11-17', 26, 844.29, 900, 1744.29),
    ('34121', '2025-11-18', 26, 848.95, 900, 1748.95),
    ('34121', '2025-11-19', 26, 836.85, 900, 1736.85),
    ('34121', '2025-11-20', 26, 855.44, 900, 1755.44),
    ('34121', '2025-11-21', 37, 1239.44, 2250, 3489.44),
    ('34121', '2025-11-22', 37, 1205.3, 2250, 3455.3),
    ('34121', '2025-11-23', 37, 1218.51, 2250, 3468.51),
    ('34200', '2025-11-17', 9, 310.88, 200, 510.88),
    ('34200', '2025-11-18', 9, 324.39, 200, 524.39),
    ('34200', '2025-11-19', 17, 610.07, 400, 1010.07),
    ('34200', '2025-11-20', 14, 495.99, 200, 695.99),
    ('34200', '2025-11-21', 9, 328.62, 200, 528.62),
    ('34200', '2025-11-22', 17, 599.46, 400, 999.46),
    ('34200', '2025-11-23', 26, 915.4, 900, 1815.4),
    ('34265', '2025-11-17', 26, 820.14, 900, 1720.14),
    ('34265', '2025-11-18', 17, 607.12, 400, 1007.12),
    ('34265', '2025-11-19', 26, 895.5, 900, 1795.5),
    ('34265', '2025-11-20', 17, 577.71, 400, 977.71),
    ('34265', '2025-11-21', 26, 912.28, 900, 1812.28),
    ('34265', '2025-11-22', 26, 875.95, 900, 1775.95),
    ('34265', '2025-11-23', 26, 949.79, 900, 1849.79),
    ('34305', '2025-11-17', 9, 310.86, 200, 510.86),
    ('34305', '2025-11-18', 26, 916.46, 900, 1816.46),
    ('34305', '2025-11-21', 35, 1233.55, 900, 2133.55),
    ('34305', '2025-11-22', 37, 1297.27, 2250, 3547.27),
    ('34305', '2025-11-23', 26, 915.5, 900, 1815.5),
    ('34499', '2025-11-17', 1, 36.64, 0, 36.64),
    ('34499', '2025-11-18', 26, 914.07, 900, 1814.07),
    ('34499', '2025-11-19', 37, 1280.64, 2250, 3530.64),
    ('34499', '2025-11-20', 26, 915.92, 900, 1815.92),
    ('34499', '2025-11-21', 26, 956.11, 900, 1856.11),
    ('34499', '2025-11-22', 9, 303.59, 200, 503.59),
    ('34499', '2025-11-23', 33, 1170.77, 900, 2070.77),
    ('34586', '2025-11-17', 26, 889.26, 900, 1789.26),
    ('34586', '2025-11-18', 17, 591.19, 400, 991.19),
    ('34586', '2025-11-19', 26, 910.07, 900, 1810.07),
    ('34586', '2025-11-20', 24, 814.89, 400, 1214.89),
    ('34586', '2025-11-22', 26, 904.58, 900, 1804.58),
    ('34586', '2025-11-23', 26, 895.94, 900, 1795.94),
    ('34591', '2025-11-17', 17, 594.48, 400, 994.48),
    ('34591', '2025-11-19', 26, 908.03, 900, 1808.03),
    ('34591', '2025-11-20', 1, 33.18, 0, 33.18),
    ('34869', '2025-11-18', 2, 77.4, 0, 77.4),
    ('34869', '2025-11-22', 9, 312.99, 200, 512.99),
    ('34869', '2025-11-23', 4, 141.57, 0, 141.57),
    ('34960', '2025-11-18', 3, 117.94, 0, 117.94),
    ('34960', '2025-11-19', 9, 305.69, 200, 505.69),
    ('34960', '2025-11-20', 11, 398.53, 200, 598.53),
    ('34960', '2025-11-23', 26, 972.22, 900, 1872.22),
    ('34976', '2025-11-18', 26, 881.62, 900, 1781.62),
    ('34976', '2025-11-19', 26, 823.91, 900, 1723.91),
    ('34976', '2025-11-20', 26, 843.36, 900, 1743.36),
    ('34976', '2025-11-21', 26, 861.4, 900, 1761.4),
    ('34976', '2025-11-22', 26, 863.16, 900, 1763.16),
    ('34976', '2025-11-23', 26, 839.94, 900, 1739.94),
    ('35024', '2025-11-17', 9, 291.85, 200, 491.85),
    ('35121', '2025-11-17', 37, 1292.81, 2250, 3542.81),
    ('35121', '2025-11-18', 37, 1371.85, 2250, 3621.85),
    ('35121', '2025-11-19', 36, 1325.84, 900, 2225.84),
    ('35121', '2025-11-20', 26, 919.48, 900, 1819.48),
    ('35121', '2025-11-21', 37, 1308.35, 2250, 3558.35),
    ('35121', '2025-11-22', 29, 1044.11, 900, 1944.11),
    ('35121', '2025-11-23', 1, 38.24, 0, 38.24),
    ('35225', '2025-11-21', 1, 40.42, 0, 40.42),
    ('35252', '2025-11-21', 9, 292.44, 200, 492.44),
    ('35268', '2025-11-17', 37, 1360.82, 2250, 3610.82),
    ('35268', '2025-11-18', 37, 1337.38, 2250, 3587.38),
    ('35268', '2025-11-19', 37, 1306.65, 2250, 3556.65),
    ('35268', '2025-11-20', 37, 1310.33, 2250, 3560.33),
    ('35268', '2025-11-21', 37, 1286.37, 2250, 3536.37),
    ('35268', '2025-11-22', 37, 1359.68, 2250, 3609.68),
    ('35268', '2025-11-23', 37, 1290.9, 2250, 3540.9),
    ('35302', '2025-11-17', 17, 520.32, 400, 920.32),
    ('35302', '2025-11-19', 9, 283.98, 200, 483.98),
    ('35352', '2025-11-17', 9, 283.15, 200, 483.15),
    ('35352', '2025-11-18', 9, 290.24, 200, 490.24),
    ('35352', '2025-11-19', 17, 589.42, 400, 989.42),
    ('35352', '2025-11-20', 17, 564, 400, 964),
    ('35352', '2025-11-21', 10, 313.5, 200, 513.5),
    ('35352', '2025-11-22', 9, 283.55, 200, 483.55),
    ('35352', '2025-11-23', 1, 29.36, 0, 29.36),
    ('35360', '2025-11-17', 26, 878.47, 900, 1778.47),
    ('35360', '2025-11-18', 26, 875.7, 900, 1775.7),
    ('35360', '2025-11-19', 26, 884.97, 900, 1784.97),
    ('35360', '2025-11-20', 26, 840.62, 900, 1740.62),
    ('35360', '2025-11-21', 26, 876.64, 900, 1776.64),
    ('35360', '2025-11-22', 37, 1241.52, 2250, 3491.52),
    ('35360', '2025-11-23', 37, 1281.93, 2250, 3531.93),
    ('35393', '2025-11-18', 26, 881.59, 900, 1781.59),
    ('35393', '2025-11-19', 26, 884.07, 900, 1784.07),
    ('35393', '2025-11-20', 26, 878.64, 900, 1778.64),
    ('35393', '2025-11-22', 37, 1225.55, 2250, 3475.55),
    ('35393', '2025-11-23', 26, 887.21, 900, 1787.21),
    ('35418', '2025-11-18', 9, 319.86, 200, 519.86),
    ('35418', '2025-11-19', 26, 910.98, 900, 1810.98),
    ('35418', '2025-11-20', 5, 162.32, 0, 162.32),
    ('35418', '2025-11-21', 26, 929.2, 900, 1829.2),
    ('35418', '2025-11-22', 17, 591.55, 400, 991.55),
    ('35418', '2025-11-23', 37, 1248.62, 2250, 3498.62),
    ('35473', '2025-11-17', 26, 856.82, 900, 1756.82),
    ('35473', '2025-11-18', 37, 1217.87, 2250, 3467.87),
    ('35473', '2025-11-19', 37, 1219, 2250, 3469),
    ('35473', '2025-11-20', 37, 1224.55, 2250, 3474.55),
    ('35473', '2025-11-21', 37, 1216.6, 2250, 3466.6),
    ('35473', '2025-11-22', 37, 1241.32, 2250, 3491.32),
    ('35473', '2025-11-23', 37, 1199.07, 2250, 3449.07),
    ('35474', '2025-11-21', 26, 891.35, 900, 1791.35),
    ('35474', '2025-11-22', 26, 891.06, 900, 1791.06),
    ('35474', '2025-11-23', 31, 1050.79, 900, 1950.79),
    ('35499', '2025-11-17', 4, 136.71, 0, 136.71),
    ('35499', '2025-11-19', 26, 888.48, 900, 1788.48),
    ('35499', '2025-11-20', 26, 911.12, 900, 1811.12),
    ('35499', '2025-11-21', 26, 874.49, 900, 1774.49),
    ('35499', '2025-11-22', 26, 857.59, 900, 1757.59),
    ('35499', '2025-11-23', 20, 664.26, 400, 1064.26),
    ('35534', '2025-11-17', 2, 79.54, 0, 79.54),
    ('35625', '2025-11-17', 2, 74.44, 0, 74.44),
    ('35625', '2025-11-18', 21, 754.83, 400, 1154.83),
    ('35630', '2025-11-17', 1, 36.6, 0, 36.6),
    ('35630', '2025-11-19', 10, 366.13, 200, 566.13),
    ('35646', '2025-11-17', 9, 334.39, 200, 534.39),
    ('35646', '2025-11-18', 17, 617.44, 400, 1017.44),
    ('35646', '2025-11-19', 22, 793.46, 400, 1193.46),
    ('35646', '2025-11-20', 26, 932.38, 900, 1832.38),
    ('35646', '2025-11-21', 27, 970.74, 900, 1870.74),
    ('35646', '2025-11-22', 37, 1320.84, 2250, 3570.84),
    ('35646', '2025-11-23', 30, 1090.27, 900, 1990.27),
    ('35672', '2025-11-18', 17, 533.19, 400, 933.19),
    ('35672', '2025-11-19', 9, 292.07, 200, 492.07),
    ('35674', '2025-11-18', 17, 563.24, 400, 963.24),
    ('35674', '2025-11-19', 9, 314.44, 200, 514.44),
    ('35674', '2025-11-20', 6, 208.32, 0, 208.32),
    ('35674', '2025-11-21', 26, 849.29, 900, 1749.29),
    ('35674', '2025-11-22', 26, 825.43, 900, 1725.43),
    ('35674', '2025-11-23', 17, 538.88, 400, 938.88),
    ('35679', '2025-11-18', 2, 69.76, 0, 69.76),
    ('35679', '2025-11-19', 9, 277.92, 200, 477.92),
    ('35690', '2025-11-18', 26, 873.35, 900, 1773.35),
    ('35690', '2025-11-19', 9, 301.28, 200, 501.28),
    ('35690', '2025-11-20', 1, 32.76, 0, 32.76),
    ('35690', '2025-11-21', 26, 846.8, 900, 1746.8),
    ('35690', '2025-11-22', 17, 581.84, 400, 981.84),
    ('35690', '2025-11-23', 17, 573.66, 400, 973.66),
    ('35726', '2025-11-20', 17, 584.43, 400, 984.43),
    ('35726', '2025-11-21', 26, 872.99, 900, 1772.99),
    ('35726', '2025-11-22', 37, 1222.87, 2250, 3472.87),
    ('35726', '2025-11-23', 37, 1230.26, 2250, 3480.26),
    ('35764', '2025-11-19', 37, 1317.66, 2250, 3567.66),
    ('35764', '2025-11-21', 37, 1319.38, 2250, 3569.38),
    ('35764', '2025-11-23', 37, 1362.93, 2250, 3612.93),
    ('35835', '2025-11-18', 1, 33.71, 0, 33.71),
    ('35835', '2025-11-19', 7, 255.86, 0, 255.86),
    ('35835', '2025-11-20', 2, 85.72, 0, 85.72),
    ('35835', '2025-11-21', 26, 950.75, 900, 1850.75),
    ('35835', '2025-11-22', 26, 944.22, 900, 1844.22),
    ('35835', '2025-11-23', 26, 917.29, 900, 1817.29),
    ('35837', '2025-11-19', 1, 33.48, 0, 33.48),
    ('35840', '2025-11-18', 2, 56.48, 0, 56.48),
    ('35840', '2025-11-19', 26, 868.57, 900, 1768.57),
    ('35840', '2025-11-20', 9, 309.68, 200, 509.68),
    ('35846', '2025-11-19', 3, 107.88, 0, 107.88),
    ('35846', '2025-11-23', 17, 558.69, 400, 958.69),
    ('35868', '2025-11-20', 17, 590.48, 400, 990.48),
    ('35897', '2025-11-19', 18, 608.53, 400, 1008.53),
    ('35897', '2025-11-20', 17, 591.11, 400, 991.11),
    ('35897', '2025-11-21', 33, 1228.01, 900, 2128.01),
    ('35897', '2025-11-22', 37, 1307.21, 2250, 3557.21),
    ('35897', '2025-11-23', 37, 1299.45, 2250, 3549.45),
    ('35910', '2025-11-19', 1, 26.2, 0, 26.2),
    ('35953', '2025-11-19', 5, 169, 0, 169),
    ('35955', '2025-11-20', 17, 598.52, 400, 998.52),
    ('35955', '2025-11-21', 26, 837.39, 900, 1737.39),
    ('35955', '2025-11-22', 26, 828.15, 900, 1728.15),
    ('35955', '2025-11-23', 10, 338.94, 200, 538.94),
    ('36006', '2025-11-20', 1, 34.65, 0, 34.65),
    ('36029', '2025-11-20', 18, 647.88, 400, 1047.88),
    ('36106', '2025-11-21', 26, 858.59, 900, 1758.59),
    ('36106', '2025-11-22', 26, 837.74, 900, 1737.74),
    ('36106', '2025-11-23', 37, 1244.22, 2250, 3494.22),
    ('36107', '2025-11-22', 1, 35.84, 0, 35.84),
    ('36107', '2025-11-23', 17, 576.22, 400, 976.22),
    ('36176', '2025-11-21', 26, 878.38, 900, 1778.38),
    ('36176', '2025-11-22', 37, 1218.71, 2250, 3468.71),
    ('36176', '2025-11-23', 37, 1225.55, 2250, 3475.55),
    ('36186', '2025-11-21', 26, 923.79, 900, 1823.79),
    ('36186', '2025-11-23', 26, 943.4, 900, 1843.4),
    ('36260', '2025-11-22', 26, 889.22, 900, 1789.22),
    ('36303', '2025-11-22', 3, 107.04, 0, 107.04),
    ('36303', '2025-11-23', 2, 71.38, 0, 71.38),
    ('36323', '2025-11-21', 1, 28.52, 0, 28.52),
    ('36323', '2025-11-22', 18, 619.43, 400, 1019.43),
    ('36326', '2025-11-22', 5, 187.56, 0, 187.56),
    ('36328', '2025-11-22', 2, 53.32, 0, 53.32),
    ('36352', '2025-11-22', 17, 580.7, 400, 980.7),
    ('36359', '2025-11-22', 9, 305.98, 200, 505.98),
    ('36359', '2025-11-23', 17, 600.56, 400, 1000.56),
    ('36401', '2025-11-22', 17, 589.63, 400, 989.63),
    ('36465', '2025-11-23', 26, 875.72, 900, 1775.72)
) AS data(pidge_rider_id, date, orders, order_earning, milestone_incentive, total_payout)
JOIN riders r ON r.pidge_rider_id = data.pidge_rider_id
ON CONFLICT (rider_id, date) DO UPDATE SET
    pidge_orders = EXCLUDED.pidge_orders,
    pidge_daily_earning = EXCLUDED.pidge_daily_earning,
    pidge_daily_incentive = EXCLUDED.pidge_daily_incentive,
    pidge_total = EXCLUDED.pidge_total,
    slab_amount = EXCLUDED.slab_amount,
    final_payout = EXCLUDED.final_payout;
